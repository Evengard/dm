@using DM.Services.Core.Extensions
@using DM.Web.Classic.Extensions.IconFontExtensions
@using Microsoft.AspNetCore.Routing
@model DM.Web.Classic.Views.Shared.GameList.GameLink.GameLinkViewModel
<li class="modulesList-item leftMenu-list-item@(Model.IsCurrentModule ? " current-module" : string.Empty)">
    <span>
        @{
            var linkClasses = new List<string>();
            if (Model.IsNew)
            {
                linkClasses.Add("module-new");
            }
            if (Model.IsCurrentModule)
            {
                linkClasses.Add("current-module");
            }
            var linkClass = string.Join(" ", linkClasses);
        }

        @Html.ActionLink(Model.Title, "Index", "Game",
            new RouteValueDictionary {{"gameId", Model.GameId.EncodeToReadable(Model.Title)}},
            new Dictionary<string, object>
            {
                {"title", $"Мастер: {Model.MasterLogin}\r\nСистема: {Model.SystemName}\r\nСеттинг: {Model.SettingName}"},
                {"class", linkClass}
            })
    </span>
    @if (Model.HasUnreadCounters)
    {
        <span class="notification-unread">
            <a href="@Url.Action("GetFirstUnreadPostInModule", "Post", new RouteValueDictionary {{"gameId", Model.GameId.EncodeToReadable(Model.Title)}})" class="@linkClass">@Html.UnreadPostsIcon(Model.UnreadCountPosts, false)</a>@*
            *@&nbsp;<span class="notificaion-unread-separator">|</span>&nbsp;@*
            *@<a href="@Url.Action("LastUnread", "GameCommentaries", new RouteValueDictionary {{"moduleIdEncoded", Model.GameId.EncodeToReadable(Model.Title)}})" class="@linkClass">@Html.UnreadCommentsIcon(Model.UnreadCountComments, false)</a>
            @if (Model.HasUnseenCharacterCounters && Model.UnseenCountCharacters > 0)
            {
                <span class="notificaion-unread-separator">|</span>
                <a href="@Url.Action("Index", "CharactersList", new RouteValueDictionary {{"gameId", Model.GameId.EncodeToReadable(Model.Title)}})" class="@linkClass">
                    @IconFont.Render(IconType.User)
                    @Model.UnseenCountCharacters
                </a>
            }
        </span>
    }
</li>