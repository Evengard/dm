@using DM.Services.DataAccess.BusinessObjects.Users
@using DM.Web.Classic.Extensions.HtmlHelperExtensions
@model DM.Web.Classic.Views.Account.Activation.UpdatePasswordForm
@{
    ViewBag.Title = "Установка нового пароля";
    Layout = "~/Views/Shared/Layout/_TwoColumnLayout.cshtml";
}

@section LeftColumn
{
    @await Html.PartialAsync("Layout/GeneralLeftColumn")
}

@using (Html.BeginForm("UpdatePassword", "Account", FormMethod.Post, new Dictionary<string, object>{{"id", "UpdatePasswordForm"}}))
{
    @Html.HiddenFor(m => m.TokenId)

    if (Model.TokenType == TokenType.Registration)
    {
        @:Поздравляем с успешной регистрацией на нашем сайте, @Model.Login. Осталось совсем немного - ввести пароль, с которым вы будете заходить на сайт.
    }
    else
    {
        @:Осталось только ввести новый пароль!
    }

    <div class="form-field-wrapper">
        @Html.LabelFor(m => m.Password, "Пароль:", new Dictionary<string, object>{{"class", "form-field-label"}})
        @Html.PasswordFor(m => m.Password)
        @Html.ValidationMessageFor(m => m.Password)
    </div>
    <div class="form-field-wrapper">
        @Html.LabelFor(m => m.PasswordConfirmation, "Подтверждение пароля:", new Dictionary<string, object> { { "class", "form-field-label" } })
        @Html.PasswordFor(m => m.PasswordConfirmation)
        @Html.ValidationMessageFor(m => m.PasswordConfirmation)
    </div>
    @Html.Submit("Установить пароль")
}

@section FooterScript
{
    <script>
        var form = new DM.FormControl("#UpdatePasswordForm");
        form.on("requestSuccess", function() {
            document.location.href = "@Url.Action("Index", "Home")";
        });
        DM.Ready();
    </script>
}
